<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…’ç«¥ä»»å‹™é›†é» App (æœ¬åœ°å„²å­˜)</title>
    <!-- è¼‰å…¥ Tailwind CSS CDNï¼Œå¯¦ç¾å¿«é€Ÿç¾è§€çš„éŸ¿æ‡‰å¼è¨­è¨ˆ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ä½¿ç”¨ Inter å­—é«” */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
        }
        /* éš±è—åŸç”Ÿæ»¾å‹•æ¢ */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* é»æ•¸æ›´æ–°æ™‚çš„è¦–è¦ºå›é¥‹ */
        .points-display.scale-105 {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.5), 0 4px 6px -2px rgba(99, 102, 41, 0.3);
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col items-center p-4">

    <!-- ğŸ’¡ é…ç½®ç‹€æ…‹è¨ºæ–·å€å¡Š (å·²ç§»é™¤ Firebase è¨ºæ–·) -->
    <div id="config-status" class="w-full max-w-xl mb-4 p-3 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 rounded-lg">
        <p class="font-bold">âœ¨ è³‡æ–™å„²å­˜æ–¹å¼ï¼šæœ¬åœ°å„²å­˜ (LocalStorage)</p>
        <p class="text-sm">âš ï¸ **è³‡æ–™åƒ…å„²å­˜åœ¨æ‚¨ç›®å‰çš„ç€è¦½å™¨ä¸­ï¼Œç„¡æ³•è·¨è£ç½®åŒæ­¥ã€‚**</p>
    </div>
    <!-- ğŸ’¡ è¨ºæ–·å€å¡ŠçµæŸ -->

    <!-- ä¸»æ‡‰ç”¨ç¨‹å¼å®¹å™¨ -->
    <div id="app-container" class="w-full max-w-xl bg-white shadow-xl rounded-2xl p-6 md:p-8 space-y-6">
        
        <!-- æ‡‰ç”¨ç¨‹å¼æ¨™é¡Œå’Œä½¿ç”¨è€… ID å€å¡Š -->
        <header class="text-center space-y-2">
            <h1 class="text-3xl font-bold text-indigo-700">ğŸ† å…’ç«¥ä»»å‹™é›†é» App</h1>
            <div class="text-xs text-gray-500 truncate">
                å„²å­˜é‡‘é‘°: <span id="storage-key-display" class="font-mono bg-gray-100 px-2 py-1 rounded">CHORE_APP_DATA</span>
            </div>
            <p class="text-sm text-gray-400">é»æ•¸èˆ‡é€²åº¦å·²å„²å­˜æ–¼æ‚¨çš„ç€è¦½å™¨ä¸­</p>
        </header>

        <!-- Home View: é¸æ“‡ä½¿ç”¨è€…ä»‹é¢ -->
        <div id="home-view" class="space-y-6 pt-4">
            <h2 class="text-2xl font-bold text-gray-700 text-center">è«‹é¸æ“‡ä½¿ç”¨è€…</h2>
            <p id="home-date-display" class="text-base text-indigo-500 text-center font-medium"></p> 
            <div class="grid grid-cols-2 gap-6">
                <!-- å§Šå§Šå¡ç‰‡ -->
                <div data-sibling="sister" class="sibling-card bg-pink-100 p-6 rounded-xl shadow-md hover:shadow-lg transition-transform transform hover:scale-105 cursor-pointer flex flex-col items-center space-y-3 border-b-4 border-pink-500">
                    <span class="text-5xl">ğŸ‘‘</span>
                    <h3 class="text-xl font-bold text-pink-700">å§Šå§Š</h3>
                    <p class="text-sm text-pink-600 font-medium">é»æ“Šé€²å…¥</p>
                </div>
                <!-- å¼Ÿå¼Ÿå¡ç‰‡ -->
                <div data-sibling="brother" class="sibling-card bg-blue-100 p-6 rounded-xl shadow-md hover:shadow-lg transition-transform transform hover:scale-105 cursor-pointer flex flex-col items-center space-y-3 border-b-4 border-blue-500">
                    <span class="text-5xl">ğŸš€</span>
                    <h3 class="text-xl font-bold text-blue-700">å¼Ÿå¼Ÿ</h3>
                    <p class="text-sm text-blue-600 font-medium">é»æ“Šé€²å…¥</p>
                </div>
            </div>
        </div>

        <!-- Task View: ä»»å‹™èˆ‡é»æ•¸ä»‹é¢ (éš±è—) -->
        <div id="task-view" class="space-y-6 pt-4 hidden">
            <!-- å„€è¡¨æ¿é ‚éƒ¨èˆ‡åˆ‡æ›æŒ‰éˆ• -->
            <div class="flex justify-between items-center mb-4 p-3 bg-indigo-50 rounded-xl shadow-sm border-l-4 border-indigo-400">
                <h2 id="current-sibling-name" class="text-2xl font-bold text-indigo-700"></h2>
                <button id="switch-sibling-btn" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full hover:bg-gray-300 transition duration-150 text-sm font-medium">
                    åˆ‡æ›ä½¿ç”¨è€…
                </button>
            </div>
            <p id="task-date-display" class="text-sm text-gray-500 text-right -mt-4 mb-2"></p>

            <!-- ä»»å‹™é»æ•¸é¡¯ç¤ºå€å¡Š -->
            <div id="points-display" class="points-display bg-indigo-50 border-2 border-indigo-200 p-4 rounded-xl shadow-inner flex justify-between items-center transition duration-300">
                <p class="text-lg font-semibold text-indigo-800">ç¸½é»æ•¸ (æœªå…Œæ›):</p>
                <span id="total-points" class="text-4xl font-extrabold text-indigo-900">0</span>
            </div>

            <!-- çç« å…Œæ›èˆ‡é¡¯ç¤ºå€å¡Š -->
            <div class="space-y-4 pt-4 border-t border-gray-100">
                <h2 class="text-xl font-bold text-gray-700">ğŸ–ï¸ çç« å…Œæ›ä¸­å¿ƒ</h2>
                <div id="medal-center" class="space-y-3">
                    <!-- å°çç«  -->
                    <div class="flex justify-between items-center bg-yellow-50 p-4 rounded-xl border border-yellow-200">
                        <div class="flex items-center space-x-3">
                            <span class="text-3xl">ğŸ…</span>
                            <div class="flex flex-col">
                                <span class="font-bold text-yellow-800">å°çç«  (50 é»)</span>
                                <span id="small-medals-count" class="text-sm text-gray-600">æ“æœ‰: 0 å€‹</span>
                            </div>
                        </div>
                        <button data-type="small" data-cost="50" 
                                class="redeem-btn bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed transition duration-150">
                            å…Œæ›
                        </button>
                    </div>

                    <!-- ä¸­çç«  -->
                    <div class="flex justify-between items-center bg-gray-200 p-4 rounded-xl border border-gray-300">
                        <div class="flex items-center space-x-3">
                            <span class="text-3xl">ğŸ¥ˆ</span>
                            <div class="flex flex-col">
                                <span class="font-bold text-gray-700">ä¸­çç«  (100 é»)</span>
                                <span id="medium-medals-count" class="text-sm text-gray-600">æ“æœ‰: 0 å€‹</span>
                            </div>
                        </div>
                        <button data-type="medium" data-cost="100" 
                                class="redeem-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed transition duration-150">
                            å…Œæ›
                        </button>
                    </div>
                    
                    <!-- å¤§çç«  -->
                    <div class="flex justify-between items-center bg-red-100 p-4 rounded-xl border border-red-300">
                        <div class="flex items-center space-x-3">
                            <span class="text-3xl">ğŸ¥‡</span>
                            <div class="flex flex-col">
                                <span class="font-bold text-red-800">å¤§çç«  (200 é»)</span>
                                <span id="large-medals-count" class="text-sm text-gray-600">æ“æœ‰: 0 å€‹</span>
                            </div>
                        </div>
                        <button data-type="large" data-cost="200" 
                                class="redeem-btn bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full text-sm disabled:opacity-50 disabled:cursor-not-allowed transition duration-150">
                            å…Œæ›
                        </button>
                    </div>
                </div>
            </div>

            <!-- ä»»å‹™åˆ—è¡¨ -->
            <div class="space-y-4 pt-4 border-t border-gray-100">
                <h2 class="text-xl font-bold text-gray-700 border-b pb-2">å¾…å®Œæˆä»»å‹™</h2>
                <div id="chore-list" class="space-y-3 hide-scrollbar max-h-96 overflow-y-auto">
                    <!-- ä»»å‹™æœƒé€é JavaScript æ¸²æŸ“åˆ°é€™è£¡ -->
                    <p id="loading-indicator" class="text-center text-gray-500">è¼‰å…¥ä»»å‹™ä¸­...</p>
                </div>
            </div>
        </div>
        
        <!-- è¨Šæ¯å½ˆå‡ºå€å¡Š -->
        <div id="message-container" class="fixed top-4 right-4 z-50 space-y-2"></div>
    </div>

    <!-- æ‡‰ç”¨ç¨‹å¼é‚è¼¯ (ä½¿ç”¨ LocalStorage) -->
    <script>
        // --- 1. å…¨åŸŸè®Šæ•¸èˆ‡åˆå§‹åŒ– ---
        const STORAGE_KEY = 'KIDS_CHORE_APP_DATA';
        const SIBLING_NAMES = { 'sister': 'å§Šå§Š', 'brother': 'å¼Ÿå¼Ÿ' };

        let appData = {};
        let selectedSibling = null;

        // ç¡¬ç·¨ç¢¼çš„é è¨­ä»»å‹™åˆ—è¡¨ (åˆ†åˆ¥ç‚ºå§Šå§Šå’Œå¼Ÿå¼Ÿ)
        const DEFAULT_CHORES_CONFIGS = {
            sister: [
                { name: "æ•´ç†æˆ¿é–“ (å§Š)", points: 10 },
                { name: "æ´—ç¢— (å§Š)", points: 15 },
                { name: "é–±è®€ 30 åˆ†é˜ (å§Š)", points: 20 },
                { name: "ç·´ç¿’é‹¼ç´ 15 åˆ†é˜", points: 25 }
            ],            
            brother: [
                { name: "æ•´ç†ç©å…· (å¼Ÿ)", points: 10 },
                { name: "å€’åƒåœ¾ (å¼Ÿ)", points: 5 },
                { name: "æ¾†èŠ±", points: 10 },
                { name: "ç·´ç¿’å¯«å­— 10 åˆ†é˜", points: 20 }
            ]
        };

        // --- 2. å·¥å…·å‡½æ•¸ ---

        // è¨Šæ¯é¡¯ç¤ºå·¥å…· (å–ä»£ alert)
        function showMessage(text, type = 'success') {
            const container = document.getElementById('message-container');
            const color = type === 'success' ? 'bg-green-500' : type === 'info' ? 'bg-indigo-500' : 'bg-red-500';
            const message = document.createElement('div');
            message.className = `p-3 rounded-lg shadow-xl text-white font-medium ${color} transition-all duration-300 transform translate-y-0`;
            message.textContent = text;
            
            container.appendChild(message);
            
            setTimeout(() => {
                message.classList.add('opacity-0', 'translate-y-4');
                message.addEventListener('transitionend', () => message.remove());
            }, 3000);
        }

        /**
         * æ ¼å¼åŒ–ä»Šå¤©çš„æ—¥æœŸ
         */
        function formatDate() {
            const date = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                weekday: 'long' 
            };
            return date.toLocaleDateString('zh-Hant-TW', options); 
        }

        /**
         * æ›´æ–°é¦–é å’Œä»»å‹™é ä¸Šçš„æ—¥æœŸé¡¯ç¤º
         */
        function updateDateDisplays() {
            const dateString = formatDate();
            const homeDisplay = document.getElementById('home-date-display');
            const taskDisplay = document.getElementById('task-date-display');

            if (homeDisplay) homeDisplay.textContent = `ä»Šå¤©æ—¥æœŸï¼š${dateString}`;
            if (taskDisplay) taskDisplay.textContent = `ä»Šå¤©æ—¥æœŸï¼š${dateString}`;
        }
        
        // --- 3. LocalStorage é‚è¼¯ ---

        /**
         * å¾ LocalStorage è¼‰å…¥è³‡æ–™ï¼Œå¦‚æœä¸å­˜åœ¨å‰‡åˆå§‹åŒ–ã€‚
         */
        function loadAppData() {
            const dataString = localStorage.getItem(STORAGE_KEY);
            if (dataString) {
                appData = JSON.parse(dataString);
            } else {
                // åˆå§‹åŒ–é è¨­çµæ§‹ - ä¿®æ­£ï¼šå‚³å…¥ä½¿ç”¨è€… ID
                appData = {
                    sister: initializeSiblingDefaultData('sister'),
                    brother: initializeSiblingDefaultData('brother')
                };
                saveAppData();
                showMessage("å·²å»ºç«‹æ–°çš„æœ¬åœ°å„²å­˜è³‡æ–™ã€‚", 'info');
            }
        }

        /**
         * å„²å­˜è³‡æ–™åˆ° LocalStorageã€‚
         */
        function saveAppData() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
        }

        /**
         * å–å¾—å–®ä¸€å­©å­çš„é è¨­è³‡æ–™çµæ§‹ã€‚
         * @param {string} siblingId - å­©å­çš„ ID ('sister' æˆ– 'brother')
         * ä¿®æ­£ï¼šåŠ å…¥ siblingId åƒæ•¸ï¼Œä¸¦ä½¿ç”¨ DEFAULT_CHORES_CONFIGS[siblingId]
         */
        function initializeSiblingDefaultData(siblingId) {
            const choresConfig = DEFAULT_CHORES_CONFIGS[siblingId] || []; // ç²å–æ­£ç¢ºçš„ä»»å‹™æ¸…å–®
            return {
                points: 0,
                smallMedals: 0,
                mediumMedals: 0,
                largeMedals: 0,
                // ç‚ºæ¯å€‹ä»»å‹™åˆ†é…ä¸€å€‹ç©©å®šçš„ ID
                chores: choresConfig.map((c, index) => ({ 
                    id: index + 1, 
                    name: c.name, 
                    points: c.points, 
                    isCompleted: false 
                })),
                lastUpdated: new Date().toISOString().split('T')[0] // å„²å­˜ä¸Šæ¬¡æ›´æ–°æ—¥æœŸ
            };
        }

        /**
         * æª¢æŸ¥ä¸¦é‡ç½®æ¯æ—¥ä»»å‹™ã€‚
         */
        function checkAndResetChores(siblingId) {
            const today = new Date().toISOString().split('T')[0];
            const siblingData = appData[siblingId];
            
            // ä¿®æ­£ï¼šæª¢æŸ¥ä»»å‹™åˆ—è¡¨æ˜¯å¦èˆ‡ç•¶å‰é…ç½®ä¸åŒï¼Œå¦‚æœä¸åŒå‰‡ç”¨æ–°é…ç½®è¦†è“‹
            const currentConfigChores = DEFAULT_CHORES_CONFIGS[siblingId];
            if (siblingData.chores.length !== currentConfigChores.length || 
                siblingData.chores.some((c, i) => c.name !== currentConfigChores[i].name)) {
                
                console.log(`åµæ¸¬åˆ°ä»»å‹™é…ç½®æ›´æ–°ï¼Œé‡ç½® ${siblingId} çš„ä»»å‹™åˆ—è¡¨...`);
                appData[siblingId] = initializeSiblingDefaultData(siblingId);
                saveAppData();
                showMessage(`${SIBLING_NAMES[siblingId]} çš„ä»»å‹™é…ç½®å·²æ›´æ–°ã€‚`, 'info');
                return; 
            }

            if (siblingData.lastUpdated !== today) {
                console.log(`åµæ¸¬åˆ°æ–°çš„ä¸€å¤©ï¼Œé‡ç½® ${siblingId} çš„ä»»å‹™...`);
                
                // é‡ç½®ä»»å‹™ç‹€æ…‹
                siblingData.chores = siblingData.chores.map(c => ({ 
                    ...c, 
                    isCompleted: false 
                }));
                siblingData.lastUpdated = today;
                
                saveAppData();
                showMessage(`æ¯æ—¥ä»»å‹™å·²ç‚º ${SIBLING_NAMES[siblingId]} é‡ç½®ï¼è«‹é‡æ–°æ‰“å¡ã€‚`, 'info');
            }
        }

        // --- 4. æ¸²æŸ“é‚è¼¯ ---

        // æ¸²æŸ“æ‡‰ç”¨ç¨‹å¼çš„ä¸»è¦è¦–åœ–
        function renderApp() {
            const homeView = document.getElementById('home-view');
            const taskView = document.getElementById('task-view');
            
            updateDateDisplays();

            if (selectedSibling) {
                // é¡¯ç¤ºä»»å‹™é 
                checkAndResetChores(selectedSibling); // æª¢æŸ¥ä¸¦é‡ç½®
                
                const name = SIBLING_NAMES[selectedSibling];
                document.getElementById('current-sibling-name').textContent = `${name} çš„ä»»å‹™å„€è¡¨æ¿`;
                homeView.classList.add('hidden');
                taskView.classList.remove('hidden');
                
                // æ¸²æŸ“ç•¶å‰å­©å­çš„æ•¸æ“š
                renderSiblingData(appData[selectedSibling]);
            } else {
                // é¡¯ç¤ºé¦–é 
                taskView.classList.add('hidden');
                homeView.classList.remove('hidden');
            }
        }

        // æ¸²æŸ“æ‰€æœ‰ç›¸é—œæ•¸æ“š
        function renderSiblingData(data) {
            renderMedalState(data);
            renderChoreList(data.chores);
        }

        // æ¸²æŸ“ä»»å‹™åˆ—è¡¨
        function renderChoreList(chores) {
            const listElement = document.getElementById('chore-list');
            listElement.innerHTML = '';
            
            const uncompletedChores = chores.filter(c => !c.isCompleted);

            if (uncompletedChores.length === 0) {
                listElement.innerHTML = '<p class="text-center text-gray-500 p-4 bg-green-50 rounded-lg font-semibold">ä»Šæ—¥ä»»å‹™å·²å…¨æ•¸å®Œæˆï¼ğŸ¥³</p>';
                return;
            }

            uncompletedChores.sort((a, b) => b.points - a.points); 

            uncompletedChores.forEach(chore => {
                const item = document.createElement('div');
                item.className = 'flex items-center justify-between bg-white border border-gray-200 p-4 rounded-xl shadow-sm hover:shadow-md transition duration-200';
                item.innerHTML = `
                    <div class="flex flex-col">
                        <span class="text-lg font-semibold text-gray-800">${chore.name}</span>
                        <span class="text-sm text-indigo-500 font-medium">é»æ•¸: +${chore.points}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button data-id="${chore.id}" data-points="${chore.points}" 
                                class="complete-btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full text-sm shadow-md transition duration-150 active:translate-y-0.5">
                            æ‰“å¡å®Œæˆ
                        </button>
                    </div>
                `;
                listElement.appendChild(item);
            });
        }
        
        // æ¸²æŸ“é»æ•¸ã€çç« ç‹€æ…‹ä¸¦å•Ÿç”¨/ç¦ç”¨å…Œæ›æŒ‰éˆ•
        function renderMedalState(data) {
            const currentPoints = data.points || 0;
            const medals = { 
                smallMedals: data.smallMedals || 0, 
                mediumMedals: data.mediumMedals || 0, 
                largeMedals: data.largeMedals || 0 
            };
            
            document.getElementById('total-points').textContent = currentPoints;

            // é»æ•¸æ›´æ–°è¦–è¦ºæ•ˆæœ
            const display = document.getElementById('points-display');
            display.classList.add('scale-105');
            setTimeout(() => display.classList.remove('scale-105'), 300);

            const medalTypes = [
                { id: 'small', cost: 50, countId: 'small-medals-count' },
                { id: 'medium', cost: 100, countId: 'medium-medals-count' },
                { id: 'large', cost: 200, countId: 'large-medals-count' }
            ];

            medalTypes.forEach(medal => {
                const countElement = document.getElementById(medal.countId);
                const button = document.querySelector(`.redeem-btn[data-type="${medal.id}"]`);
                
                // æ¸²æŸ“æ•¸é‡
                const count = medals[`${medal.id}Medals`] || 0;
                countElement.textContent = `æ“æœ‰: ${count} å€‹`;
                
                // å•Ÿç”¨/ç¦ç”¨æŒ‰éˆ•
                if (button) {
                    const isRedeemable = currentPoints >= medal.cost;
                    button.disabled = !isRedeemable;
                    button.textContent = isRedeemable ? 'å…Œæ›' : `é»æ•¸ä¸è¶³ (${medal.cost} é»)`;
                }
            });
        }
        
        // --- 5. äº‹ä»¶è™•ç†å™¨èˆ‡æ•¸æ“šæ›´æ–° ---

        // ä»»å‹™å®Œæˆé‚è¼¯
        function completeChore(choreId, points) {
            const siblingData = appData[selectedSibling];
            
            // æ‰¾åˆ°ä¸¦æ¨™è¨˜ç‚ºå®Œæˆ
            const choreIndex = siblingData.chores.findIndex(c => c.id === choreId);
            if (choreIndex !== -1 && !siblingData.chores[choreIndex].isCompleted) {
                siblingData.chores[choreIndex].isCompleted = true;
                siblingData.points += points;
                
                saveAppData(); // å„²å­˜è®Šæ›´
                renderSiblingData(siblingData); // é‡æ–°æ¸²æŸ“ UI
                showMessage(`${SIBLING_NAMES[selectedSibling]} å®Œæˆä»»å‹™ï¼ç²å¾— ${points} é»ã€‚`);
            }
        }

        // å…Œæ›çç« é‚è¼¯
        function redeemMedal(medalType, cost) {
            const siblingData = appData[selectedSibling];
            const medalKey = `${medalType}Medals`;

            if (siblingData.points < cost) {
                showMessage("é»æ•¸ä¸è¶³ï¼Œç„¡æ³•å…Œæ›ã€‚", 'error');
                return;
            }

            siblingData.points -= cost;
            siblingData[medalKey] += 1;

            saveAppData(); // å„²å­˜è®Šæ›´
            renderSiblingData(siblingData); // é‡æ–°æ¸²æŸ“ UI
            
            const medalNameMap = { 'small': 'å°', 'medium': 'ä¸­', 'large': 'å¤§' };
            const medalName = medalNameMap[medalType] || 'æœªçŸ¥';
            showMessage(`æˆåŠŸå…Œæ› 1 å€‹${medalName}çç« ï¼èŠ±è²» ${cost} é»ã€‚`);
        }


        document.addEventListener('click', (e) => {
            const button = e.target.closest('button, .sibling-card');
            if (!button) return;

            // --- è™•ç†é¦–é é¸æ“‡ ---
            if (button.classList.contains('sibling-card')) {
                selectedSibling = button.dataset.sibling;
                renderApp();
                return;
            }
            
            // --- è™•ç†åˆ‡æ›ä½¿ç”¨è€… ---
            if (button.id === 'switch-sibling-btn') {
                selectedSibling = null;
                renderApp();
                return;
            }

            if (!selectedSibling) return;

            // --- è™•ç†çç« å…Œæ› ---
            if (button.classList.contains('redeem-btn')) {
                const medalType = button.dataset.type;
                const cost = parseInt(button.dataset.cost, 10);
                if (!button.disabled) {
                    redeemMedal(medalType, cost);
                }
                return;
            }

            // --- è™•ç†ä»»å‹™å®Œæˆ ---
            if (button.classList.contains('complete-btn')) {
                const choreId = parseInt(button.dataset.id, 10);
                const points = parseInt(button.dataset.points, 10);
                completeChore(choreId, points);
            }
        });


        // --- 6. å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼ ---
        window.onload = () => {
            loadAppData(); // è¼‰å…¥æˆ–åˆå§‹åŒ–æœ¬åœ°æ•¸æ“š
            renderApp(); // æ¸²æŸ“ä»‹é¢
        };

        
    </script>
</body>
</html>